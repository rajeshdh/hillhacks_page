YUI.add("hermes-template-context-text",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u="function",a=this.escapeExpression;return s+='\n\n<span data-loaded="true" style="left:',(o=n.left)?o=o.call(t,{hash:{},data:i}):(o=t.left,o=typeof o===u?o.apply(t):o),s+=a(o)+';float:left;display:block;position:absolute;height:40px;width:86px;border:1px solid #ccc;" href="#">\n	',(o=n.text)?o=o.call(t,{hash:{},data:i}):(o=t.text,o=typeof o===u?o.apply(t):o),s+=a(o)+"\n</span>\n\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/context-text",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("context-slider-scrappy-view",function(e){e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){return this.photoId=t.photoId,this.contextData=e.clone(t.context,!0),this.currentPosition=0,this.numberOfPhotosEitherSideInViewPort=3,this.numberOfPositionsToMove=3,this.numberOfPositionsToBuffer=3,this.positionsLoadedNext=0,this.positionsLoadedPrev=0,this.positionsAheadLimit=25,this.numberOfPositionsToPreFetch=6,this.photoWidth=50,this.photoMargin=15,this.photoWidthPlusMargin=65,this.photoWidthSmall=20,this.photoMarginSmall=5,this.photoWidthPlusMarginSmall=25,this.atStart=!1,this.atEnd=!1,this.isAd=!!t.ad,this.photosInSlider={},!YUI.Env.isServer&&e.StorageHelper.getItem("slideshowInProgress")==="true"?this.slideshowInProgress=!0:this.slideshowInProgress=!1,this.slideshowDwellSeconds=5,this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this},loadState:function(){var t=this,n=t.contextData,r=new e.FlickrPromise({photo:t.appContext.getModel("photo-models",t.photoId),context:t.appContext.getModel(n.modelName,n.params)});return r.then(function(e){t.set("photo",e.photo),t.set("contextModel",e.context)},function(e){if(!e.getModelFailure&&e.code!==1||n.modelName==="photostream-models")throw e;return t.contextData.modelName="photostream-models",t.appContext.getModel("photo-models",t.photoId).then(function(e){return t.set("photo",e),t.contextData.params.id=t.get("photo").getValue("owner").getValue("nsid"),t.appContext.getModel("photostream-models",t.contextData.params).then(function(e){t.set("contextModel",e)})})}).then(function(){var r=e.merge(n.params,{photoId:t.photoId,numNext:t.numberOfPositionsToPreFetch,numPrev:t.numberOfPositionsToPreFetch,viewAs:t.contextData.viewAs,refetchAt:t.numberOfPositionsToPreFetch*2});return t.get("contextModel").getValue("photoContextList").getContext(r)}).then(function(e){t.positionsLoadedNext=t.positionsLoadedNext+e.next.length,t.positionsLoadedPrev=t.positionsLoadedPrev+e.previous.length,t.photosInSlider[0]=t.get("photo").getValue("id"),t.set("initialContextResponse",e)},function(e){if(e.notInContext)return t.get("contextModel").setValue("photoContextList",[]),t.contextData.modelName="photostream-models",t.contextData.params.id=t.get("photo").getValue("owner").getValue("nsid"),t.loadState();throw e}).then(null,function(e){throw t.appContext.warn("There was a problem loading the context slider data.",e&&e.message?e.message:e,e&&e.stack?e.stack:""),e})},assignContextPositionsAndAddToDOM:function(e){var t=this.get("container"),n=t.one(".small-slider .slider"),r=t.one(".big-slider .slider"),i=e.contextResponse,s,o,u;for(u=0;u<i.previous.length;u++)o=-1-u,typeof this.photosInSlider[o]=="undefined"&&(s=i.previous[u].toJSON(),this.photosInSlider[o]=i.previous[u].getValue("id"),s.left=o*this.photoWidthPlusMarginSmall,s.background=this.getBackgroundImage(i.previous[u]),s.url=this.getContextifiedURLForPhoto(i.previous[u]),n.append(this.templates("context-slider-photo")(s)),s.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(s)));for(u=0;u<i.next.length;u++)o=1+u,typeof this.photosInSlider[o]=="undefined"&&(s=i.next[u].toJSON(),this.photosInSlider[o]=i.next[u].getValue("id"),s.left=o*this.photoWidthPlusMarginSmall,s.background=this.getBackgroundImage(i.next[u]),s.url=this.getContextifiedURLForPhoto(i.next[u]),n.append(this.templates("context-slider-photo")(s)),s.left=o*this.photoWidthPlusMargin,r.append(this.templates("context-slider-photo")(s)))},checkBoundary:function(e){var t=e.contextResponse,n=e.requestedPreviousAmount,r=e.requestedNextAmount,i=e.positionWhenChecking,s=this.get("contextModel").getValue("photoContextList"),o=this.get("container"),u=o.one(".nav-l"),a=o.one(".nav-r");this.currentPosition-this.numberOfPhotosEitherSideInViewPort>this.positionsLoadedNext&&this.move(-Math.abs(this.currentPosition-this.positionsLoadedNext)),this.currentPosition<0&&Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)>this.positionsLoadedPrev&&this.move(Math.abs(this.currentPosition+this.numberOfPhotosEitherSideInViewPort)-this.positionsLoadedPrev),s.hasMinBoundary()&&t.previous.length-Math.abs(i)<=this.numberOfPhotosEitherSideInViewPort&&n>0&&(u.hide(),this.atStart=!0),s.hasMaxBoundary()&&t.next.length-Math.abs(i)<=this.numberOfPhotosEitherSideInViewPort&&r>0&&(a.hide(),this.atEnd=!0)},buildContainer:function(){var e=this.numberOfPhotosEitherSideInViewPort,t=this.get("photo").toJSON(),n=this.get("initialContextResponse"),r;t.background=this.getBackgroundImage(this.get("photo")),t.left=0,t.currentPhoto=!0,t.url=this.getContextifiedURLForPhoto(this.get("photo")),r=this.templates("context-slider-scrappy")({previousPhotos:[],nextPhotos:[],currentPhoto:[t],slideshowEnabled:this.appContext.flipper.isFlipped("enable-slideshow"),"is-ad":this.isAd}),this.isAd&&(n.next.pop(),n.next=[this.get("photo")].concat(n.next)),this.setContainerHTML(r),this.assignContextPositionsAndAddToDOM({contextResponse:this.get("initialContextResponse"),requestedPreviousAmount:e,requestedNextAmount:e}),this.checkBoundary({contextResponse:this.get("initialContextResponse"),requestedPreviousAmount:e,requestedNextAmount:e,positionWhenChecking:this.currentPosition})},buildErrorContainer:function(){this.setContainerHTML(this.templates("context-slider-scrappy")({loadingError:!0}))},activate:function(){var t=this,n=t.get("container"),r=!1,i,s,o=this.appContext.getViewer().prefs.keyboardShortcutsEnabled;return e.StorageHelper.getItem("showBigContextSlider")==="true"?(n.addClass("hover"),setTimeout(function(){n.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),n.all(".context-slider").setStyle("transition","opacity 300ms ease-out")},300)):(n.setStyle("transition","opacity 300ms ease-out, background-position 150ms ease-out"),n.all(".context-slider").setStyle("transition","opacity 300ms ease-out")),this.appContext.flipper.isFlipped("enable-slideshow")&&(this.slideshowInProgress&&
this.startSlideshow(),this.registerEventHandler(this.get("container").all(".currentImage").on("click",function(e){e.preventDefault(),t.slideshowInProgress?t.stopSlideshow():t.startSlideshow()}))),e.use("transition",function(e){t.registerEventHandler(t.get("container").one(".nav-l").on("click",function(){n.setStyle("transition","opacity 300ms ease-out"),e.rapidTracker.beacon(t.name,"contextSliderMoveLeftClick"),t.move(-1*t.numberOfPositionsToMove)})),t.registerEventHandler(t.get("container").one(".nav-r").on("click",function(){n.setStyle("transition","opacity 300ms ease-out"),e.rapidTracker.beacon(t.name,"contextSliderMoveRightClick"),t.move(1*t.numberOfPositionsToMove)})),o&&(t.attachKeyEvent("down:188",e.betterThrottle(function(r){e.rapidTracker.beacon(t.name,"contextSliderMoveLeftKeyPress"),n.addClass("hover"),t.bringIntoFocus(),t.atStart||t.move(-1*t.numberOfPositionsToMove)},20)),t.attachKeyEvent("down:190",e.betterThrottle(function(r){e.rapidTracker.beacon(t.name,"contextSliderMoveRightKeyPress"),n.addClass("hover"),t.bringIntoFocus(),t.atEnd||t.move(1*t.numberOfPositionsToMove)},20))),t.registerEventHandler(n.on("hover",function(){r=!0,clearTimeout(i),i=setTimeout(function(){r&&n.addClass("hover")},150)},function(){r=!1,clearTimeout(s),e.StorageHelper.setItem("showBigContextSlider","false"),s=setTimeout(function(){r||(n.setStyles({width:"100%",height:"80px"}),n.removeClass("hover"),setTimeout(function(){n.removeAttribute("style")},300))},500)})),t.registerEventHandler(n.all(".context-thumb:not(.currentImage)").on("click",function(){e.StorageHelper.setItem("showBigContextSlider","true")}))}),this},startSlideshow:function(){function s(){if(r===0&&t.slideshowInProgress){t.appContext.flapp.navigate(n);return}i.all(".currentImage .countdown-slideshow").set("text",r),r-=1}this.slideshowInProgress=!0;var t=this,n=this.getContextifiedURLForPhoto(this.get("initialContextResponse").next[0]),r=this.slideshowDwellSeconds,i=this.get("container");e.StorageHelper.setItem("slideshowInProgress","true"),i.all(".currentImage .play-slideshow").hide(),s(),this.slideshowTimer=setInterval(function(){s()},1e3)},stopSlideshow:function(){this.slideshowInProgress=!1,this.get("container").all(".currentImage .countdown-slideshow").set("text",""),this.get("container").all(".currentImage .play-slideshow").show(),clearInterval(this.slideshowTimer),e.StorageHelper.setItem("slideshowInProgress","false")},move:function(t){var n=this,r=this.get("contextModel").getValue("photoContextList"),i=t>0?"right":"left",s=this.get("container"),o=s.one(".big-slider .slider"),u=s.one(".small-slider .slider"),a,f,l,c,h,p=s.one(".nav-l"),d=s.one(".nav-r"),v;if(i==="right"&&this.currentPosition-this.positionsLoadedNext>this.positionsAheadLimit)return!1;if(i==="left"&&this.currentPosition<=0&&Math.abs(this.currentPosition)-this.positionsLoadedPrev>this.positionsAheadLimit)return!1;s.addClass("hover"),this.currentPosition+=t,v=this.currentPosition,typeof this.photosInSlider[this.currentPosition+this.numberOfPhotosEitherSideInViewPort+1]!="undefined"&&(d.show(),this.atEnd=!1),typeof this.photosInSlider[this.currentPosition-(this.numberOfPhotosEitherSideInViewPort+1)]!="undefined"&&(p.show(),this.atStart=!1),a=this.currentPosition*this.photoWidthPlusMargin*-1,f=this.currentPosition*this.photoWidthPlusMarginSmall*-1,o.transition({left:a+"px",duration:.3,easing:"ease-out"}),u.setStyle("left",f+"px"),i==="right"?c=this.currentPosition+this.numberOfPositionsToMove+this.numberOfPositionsToBuffer:i==="left"&&(c=this.currentPosition-(this.numberOfPositionsToMove+this.numberOfPositionsToBuffer)),l=typeof this.photosInSlider[c]=="undefined",l&&(h=e.merge(n.contextData.params,{photoId:this.get("photo").getValue("id"),viewAs:n.contextData.viewAs}),i==="right"?h.numNext=Math.abs(c)+this.numberOfPositionsToPreFetch:i==="left"&&(h.numPrev=Math.abs(c)+this.numberOfPositionsToPreFetch),r.getContext(h).then(function(e){n.positionsLoadedNext=typeof h.numNext!="undefined"?h.numNext:n.positionsLoadedNext,n.positionsLoadedPrev=typeof h.numPrev!="undefined"?h.numPrev:n.positionsLoadedPrev,n.assignContextPositionsAndAddToDOM({contextResponse:e,requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext}),n.checkBoundary({contextResponse:e,requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext,positionWhenChecking:v})},function(e){n.checkBoundary({contextResponse:{previous:[],next:[]},requestedPreviousAmount:h.numPrev,requestedNextAmount:h.numNext,positionWhenChecking:v})}))},getBackgroundImage:function(e){var t,n=this.appContext.getViewer().getPixelRatio(),r;return t={width:this.photoWidth*n,height:this.photoWidth*n},r={cropToFit:!0,includeSizes:["sq","t","q","s","n"]},e.getSizeToFit(t,r).url},getContextifiedURLForPhoto:function(t){if(t){var n=e.URLHelper.getPhotoPage({photoId:t.getValue("id"),pathAlias:t.getValue("owner").getValue("pathAlias"),contextSuffix:this.contextData.viewAs==="public"?"public":this.get("contextModel").getValue("urlSuffix")});return n}},beforeDestroy:function(){clearInterval(this.slideshowTimer)}})},"@VERSION@",{requires:["flickr-view","hermes-template-context-slider-scrappy","hermes-template-context-slider-photo","hermes-template-context-image","hermes-template-context-text","context-slider-scrappy-css","storage-helper"],optional:[],langBundles:["common","photo-page-scrappy"]});
YUI.add("hermes-template-photo-engagement",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var r="",i;r+='\n	<div class="wallart',i=n["if"].call(e,e.isWallartLowQuality,{hash:{},inverse:f.noop,fn:f.program(2,d,t),data:t});if(i||i===0)r+=i;return r+='">\n		<a href="#" title="Create wall art with this photo">\n			<i class="ui-icon-wallart"></i>\n		</a>\n	</div>\n',r}function d(e,t){return" dimmed"}function v(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["photo-well-scrappy-edit-view"],s):l.call(e,"outlet",e["photo-well-scrappy-edit-view"],s)))+"\n",r}function m(e,t){var r="",i,s;return r+="\n	",s={hash:{},data:t},r+=c((i=n.outlet||e.outlet,i?i.call(e,e["fave-view"],s):l.call(e,"outlet",e["fave-view"],s)))+"\n",r}function g(e,t){var r="",i,s;return r+='\n		<a href="/video_download.gne?id=',(i=n.photoId)?i=i.call(e,{hash:{},data:t}):(i=e.photoId,i=typeof i===h?i.apply(e):i),r+=c(i)+'" class="server-only-link" title="',s={hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_VIDEO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'">\n	',r}function y(e,t){var r="",i,s;return r+='\n		<a href="#" title="',s={hash:{intlName:"photo-page-scrappy.DOWNLOAD_THIS_PHOTO"},data:t},r+=c((i=n.intlMessage||e.intlMessage,i?i.call(e,s):l.call(e,"intlMessage",s)))+'">\n	',r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f=this,l=n.helperMissing,c=this.escapeExpression,h="function";o=n["if"].call(t,t.canCreateWallart,{hash:{},inverse:f.noop,fn:f.program(1,p,i),data:i});if(o||o===0)s+=o;s+="\n\n",o=n["if"].call(t,t.viewerIsOwner,{hash:{},inverse:f.program(6,m,i),fn:f.program(4,v,i),data:i});if(o||o===0)s+=o;s+='\n\n<div class=\'share\'>\n	<a href="#" title="',a={hash:{intlName:"photo-page-scrappy.SHARE_THIS_PHOTO"},data:i},s+=c((o=n.intlMessage||t.intlMessage,o?o.call(t,a):l.call(t,"intlMessage",a)))+'">\n		<i class="ui-icon-share-24"></i>\n	</a>\n</div>\n\n<div class=\'download\'>\n	',u=n["if"].call(t,t.isVideo,{hash:{},inverse:f.program(10,y,i),fn:f.program(8,g,i),data:i});if(u||u===0)s+=u;return s+='\n			<i class="ui-icon-download"></i>\n		</a>\n</div>\n',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/photo-engagement",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-download-dialog",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function p(e,t){var n="",r;return n+='\n			"'+l((r=(r=e.photo,r==null||r===!1?r:r.title),typeof r===f?r.apply(e):r))+'"\n		',n}function d(e,t){var n="",r;return n+='\n            <i class="ui-icon-tiny-'+l((r=(r=e.photo,r==null||r===!1?r:r.license),typeof r===f?r.apply(e):r))+'cc"></i>\n        ',n}function v(e,t){return'\n            <i class="ui-icon-tiny-government"></i>\n        '}function m(e,t){return'\n            <i class="ui-icon-tiny-noKnown"></i>\n        '}function g(e,t){return'\n			<i class="ui-icon-tiny-copyright">&nbsp;</i>\n		'}function y(e,t){var r="",i,s;return r+='\n		    <span class="license license-'+l((i=(i=e.photo,i==null||i===!1?i:i.license),typeof i===f?i.apply(e):i))+'">',s={hash:{intlName:"photo-page-scrappy.SOME_RIGHTS_RESERVED"},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,s):c.call(e,"intlMessage",s)))+"</span>\n		",r}function b(e,t){var r="",i,s;return r+='\n		    <span class="license license-'+l((i=(i=e.photo,i==null||i===!1?i:i.license),typeof i===f?i.apply(e):i))+'">',s={hash:{},data:t},r+=l((i=n.licenseString||e.licenseString,i?i.call(e,(i=e.photo,i==null||i===!1?i:i.license),s):c.call(e,"licenseString",(i=e.photo,i==null||i===!1?i:i.license),s)))+"</span>\n		",r}function w(e,t){var r="",i;r+='\n			<li class="',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i),i=n["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.program(16,E,t),data:t});if(i||i===0)r+=i;return r+='">\n				<a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===f?i.apply(e):i),r+=l(i)+'" data-track="downloadSizeSelected',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+'">\n					<span class="label">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===f?i.apply(e):i),r+=l(i)+'</span>\n					<span class="resolution">',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===f?i.apply(e):i),r+=l(i)+" &times; ",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===f?i.apply(e):i),r+=l(i)+"</span>\n				</a>\n			</li>\n		",r}function E(e,t){return" selected"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this;s+='<div class="download-dialog">\n	<h2>',a={hash:{intlName:"photo-page-scrappy.DOWNLOAD_PHOTO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h2>\n	<p class="title">\n		',u=n["if"].call(t,(o=t.photo,o==null||o===!1?o:o.title),{hash:{},inverse:h.noop,fn:h.program(1,p,i),data:i});if(u||u===0)s+=u;s+="\n		by "+l((o=(o=(o=t.photo,o==null||o===!1?o:o.owner),o==null||o===!1?o:o.displayname),typeof o===f?o.apply(t):o))+'\n	</p>\n	<p class="license-info">\n	<a href="',a={hash:{},data:i},s+=l((o=n.configVal||t.configVal,o?o.call(t,"licenseUrls",(o=t.photo,o==null||o===!1?o:o.license),a):c.call(t,"configVal","licenseUrls",(o=t.photo,o==null||o===!1?o:o.license),a)))+'" class="license-url" target="_newtab">\n        ',u=n["if"].call(t,t.licenseIsCreativeCommons,{hash:{},inverse:h.noop,fn:h.program(3,d,i),data:i});if(u||u===0)s+=u;s+="\n        ",u=n["if"].call(t,t.licenseisGovt,{hash:{},inverse:h.noop,fn:h.program(5,v,i),data:i});if(u||u===0)s+=u;s+="\n        ",u=n["if"].call(t,t.licenseisNoLic,{hash:{},inverse:h.noop,fn:h.program(7,m,i),data:i});if(u||u===0)s+=u;s+="\n        ",u=n["if"].call(t,t.licenseisCopy,{hash:{},inverse:h.noop,fn:h.program(9,g,i),data:i});if(u||u===0)s+=u;s+="\n		",u=n["if"].call(t,t.licenseIsCreativeCommons,{hash:{},inverse:h.program(13,b,i),fn:h.program(11,y,i),data:i});if(u||u===0)s+=u;s+='\n	</a>\n    </p>\n	<ul class="sizes">\n		',u=n.each.call(t,t.sizes,{hash:{},inverse:h.noop,fn:h.program(15,w,i),data:i});if(u||u===0)s+=u;return s+="\n	</ul>\n	<p class='buttons'>\n		<a href=\""+l((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===f?o.apply(t):o))+'/sizes/l" class="all-sizes" data-track="viewAllSizesClick">',a={hash:{intlName:"photo-page-scrappy.VIEW_ALL_SIZES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</a>\n		<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-done" data-track="downloadClick"><span>',a={hash:{intlName:"photo-page-scrappy.DOWNLOAD"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span></button>\n	</p>\n	<button class="ui-dialog-button ui-dialog-button-neutral ui-dialog-button-close hide-text"><span>&nbsp;</span></button>\n</div>',s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/download-dialog",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("hermes-template-scrappy-download-menu",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function h(e,t){var r="",i;r+="\n        ",i=n.each.call(e,e.sizes,{hash:{},inverse:l.noop,fn:l.program(2,p,t),data:t});if(i||i===0)r+=i;return r+="\n	",r}function p(e,t){var r="",i;return r+='\n		    <li class="',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+'">\n			    <a href="',(i=n.url)?i=i.call(e,{hash:{},data:t}):(i=e.url,i=typeof i===a?i.apply(e):i),r+=f(i)+'" data-track="downloadSizeSelected',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+'" class="download-image-size">\n				    <span class="label">',(i=n.label)?i=i.call(e,{hash:{},data:t}):(i=e.label,i=typeof i===a?i.apply(e):i),r+=f(i)+'</span>\n				    <span class="resolution">(',(i=n.width)?i=i.call(e,{hash:{},data:t}):(i=e.width,i=typeof i===a?i.apply(e):i),r+=f(i)+" &times; ",(i=n.height)?i=i.call(e,{hash:{},data:t}):(i=e.height,i=typeof i===a?i.apply(e):i),r+=f(i)+")</span>\n			    </a>\n		    </li>\n	    ",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a="function",f=this.escapeExpression,l=this,c=n.helperMissing;s+='<ul class="sizes">\n    ',o=n["if"].call(t,t.showDownloadSizes,{hash:{},inverse:l.noop,fn:l.program(1,h,i),data:i});if(o||o===0)s+=o;return s+='\n	<li><a href="'+f((o=(o=t.photo,o==null||o===!1?o:o.url),typeof o===a?o.apply(t):o))+'/sizes/l" class="all-sizes server-only-link" data-track="viewAllSizesClick">',u={hash:{intlName:"photo-page-scrappy.VIEW_ALL_SIZES"},data:i},s+=f((o=n.intlMessage||t.intlMessage,o?o.call(t,u):c.call(t,"intlMessage",u)))+"</a></li>\n</ul>",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/scrappy-download-menu",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("wallart-helper",function(e){"use strict";e.WallartHelper=function(e){this.validWallartTypes=["canvas","mounted"],this.appContext=e,this.dimensions=[{canvas:{FLICKR_2_1:[975,825,750,600,693,543,28.5,28.5,112.5,112.5,75,75],FLICKR_2_3:[1500,1500,1200,1200,1050,1050,75,75,150,150,100,75],FLICKR_2_2:[1700,1400,1400,1100,1250,950,75,75,150,150,100,75],FLICKR_2_4:[2300,1900,2e3,1600,1850,1450,75,75,150,150,100,75],FLICKR_2_5:[2700,2300,2400,2e3,2250,1850,75,75,150,150,100,75],FLICKR_2_6:[3300,2300,3e3,2e3,2850,1850,75,75,150,150,100,75]},mounted:{FLICKR_2_9:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_1:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_2:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_3:[1e3,800,974.666,774.666,950.668,750.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_11:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_1:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_2:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_3:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_1:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_2:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_3:[1400,1100,1375.334,1075.334,1367.112,1067.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_1:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_2:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_3:[2e3,1600,1975.334,1575.334,1967.112,1567.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_1:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_2:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_3:[3e3,2e3,2975.334,1975.334,2967.112,1967.112,4.111,4.111,12.333,12.333,100,100]}},{canvas:{FLICKR_2_1:[825,975,600,750,543,693,28.5,28.5,112.5,112.5,75,75],FLICKR_2_3:[1500,1500,1200,1200,1050,1050,75,75,150,150,100,75],FLICKR_2_2:[1400,1700,1100,1400,950,1250,75,75,150,150,100,75],FLICKR_2_4:[1900,2300,1600,2e3,1450,1850,75,75,150,150,100,75],FLICKR_2_5:[2300,2700,2e3,2400,1850,2250,75,75,150,150,100,75],FLICKR_2_6:[2300,3300,2e3,3e3,1850,2850,75,75,150,150,100,75]},mounted:{FLICKR_2_9:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_1:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_2:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_9_3:[800,1e3,774.666,974.666,750.668,950.668,12.667,12.667,12.667,12.667,100,100],FLICKR_2_11:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_1:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_2:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_11_3:[1200,1200,1175.334,1175.334,1167.112,1167.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_1:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_2:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_10_3:[1100,1400,1075.334,1375.334,1067.112,1367.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_1:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_2:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_12_3:[1600,2e3,1575.334,1975.334,1567.112,1967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_1:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_2:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100],FLICKR_2_13_3:[2e3,3e3,1975.334,2975.334,1967.112,2967.112,4.111,4.111,12.333,12.333,100,100]}}]},e.WallartHelper.prototype.getNewSku=function(e,t){var n,r;if(t.size){["FLICKR_2_1","FLICKR_2_3","FLICKR_2_2","FLICKR_2_4","FLICKR_2_5","FLICKR_2_6"].indexOf(e)>-1?r="canvas":["FLICKR_2_9","FLICKR_2_11","FLICKR_2_10","FLICKR_2_12","FLICKR_2_13"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_1","FLICKR_2_11_1","FLICKR_2_10_1","FLICKR_2_12_1","FLICKR_2_13_1"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_2","FLICKR_2_11_2","FLICKR_2_10_2","FLICKR_2_12_2","FLICKR_2_13_2"].indexOf(e)>-1?r="mounted":["FLICKR_2_9_3","FLICKR_2_11_3","FLICKR_2_10_3","FLICKR_2_12_3","FLICKR_2_13_3"].indexOf(e)>-1&&(r="mounted");switch(t.size){case"8x10":r==="canvas"?n="FLICKR_2_1":r==="mounted"&&(n="FLICKR_2_9",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"));break;case"12x12":r==="canvas"?n="FLICKR_2_3":r==="mounted"&&(n="FLICKR_2_11",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"));break;case"11x14":r==="canvas"?n="FLICKR_2_2":r==="mounted"&&(n="FLICKR_2_10",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"));break;case"16x20":r==="canvas"?n="FLICKR_2_4":r==="mounted"&&(n="FLICKR_2_12",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"));break;case"20x24":r==="canvas"&&(n="FLICKR_2_5");break;case"20x30":r==="canvas"?n="FLICKR_2_6":r==="mounted"&&
(n="FLICKR_2_13",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"))}}if(t.style)switch(t.style){case"canvas":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_1";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_3";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_2";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_4";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_6";break;case"mounted":e==="FLICKR_2_1"?(n="FLICKR_2_9",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1")):e==="FLICKR_2_3"?(n="FLICKR_2_11",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1")):e==="FLICKR_2_2"?(n="FLICKR_2_10",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1")):e==="FLICKR_2_4"?(n="FLICKR_2_12",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1")):e==="FLICKR_2_5"?(n="FLICKR_2_12",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1")):e==="FLICKR_2_6"&&(n="FLICKR_2_13",this.appContext.flipper.isFlipped("wallart-papertypes")&&(n+="_1"))}if(t.material)switch(t.material){case"lustre":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_1";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_1";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_1";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_1";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_1";break;case"glossy":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_2";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_2";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_2";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_2";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_2";break;case"matte":if(e==="FLICKR_2_9"||e==="FLICKR_2_9_1"||e==="FLICKR_2_9_2"||e==="FLICKR_2_9_3")n="FLICKR_2_9_3";else if(e==="FLICKR_2_11"||e==="FLICKR_2_11_1"||e==="FLICKR_2_11_2"||e==="FLICKR_2_11_3")n="FLICKR_2_11_3";else if(e==="FLICKR_2_10"||e==="FLICKR_2_10_1"||e==="FLICKR_2_10_2"||e==="FLICKR_2_10_3")n="FLICKR_2_10_3";else if(e==="FLICKR_2_12"||e==="FLICKR_2_12_1"||e==="FLICKR_2_12_2"||e==="FLICKR_2_12_3")n="FLICKR_2_12_3";else if(e==="FLICKR_2_13"||e==="FLICKR_2_13_1"||e==="FLICKR_2_13_2"||e==="FLICKR_2_13_3")n="FLICKR_2_13_3"}return n},e.WallartHelper.prototype.getArtDimensions=function(e,t){var n={renderedWidth:0,renderedHeight:1,shownWidth:2,shownHeight:3,guarenteedWidth:4,guarenteeHeight:5,safetyWidth:6,safetyHeight:7,bleedWidth:8,bleedHeight:9,optimumDPI:10,minimumDPI:11},r,i=[];r=this.dimensions;switch(e){case"FLICKR_2_1":i=r[t].canvas.FLICKR_2_1;break;case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":i=r[t].mounted.FLICKR_2_9;break;case"FLICKR_2_3":i=r[t].canvas.FLICKR_2_3;break;case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":i=r[t].mounted.FLICKR_2_11;break;case"FLICKR_2_2":i=r[t].canvas.FLICKR_2_2;break;case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":i=r[t].mounted.FLICKR_2_10;break;case"FLICKR_2_4":i=r[t].canvas.FLICKR_2_4;break;case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":i=r[t].mounted.FLICKR_2_12;break;case"FLICKR_2_5":i=r[t].canvas.FLICKR_2_5;break;case"FLICKR_2_6":i=r[t].canvas.FLICKR_2_6;break;case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":i=r[t].mounted.FLICKR_2_13}return{map:n,dimensions:i}},e.WallartHelper.prototype.isCC=function(e){return e.getValue("photoSource")===2?!0:!1},e.WallartHelper.prototype.isMK=function(e){return e.getValue("photoSource")===3?!0:!1},e.WallartHelper.prototype.getCorrectedLargestSize=function(e){var t,n,r;return t=e.getLargestSize({excludeSizes:[]}),r={width:t.width,height:t.height},n=e.getValue("rotation"),Math.abs(n)%180!==0&&(t.width=r.height,t.height=r.width),t},e.WallartHelper.prototype.getInitialSku=function(e,t){var n,r,i=["FLICKR_2_4","FLICKR_2_12_1","FLICKR_2_12_2","FLICKR_2_12_3"],s;return this.wallartModel=e,s=this.getCorrectedLargestSize(e.getValue("photo")),s.width>=s.height?r=0:r=1,e.setValue("isCC",this.isCC(e)),e.setValue("isMK",this.isMK(e)),n=this.getLargestSizeWallartSku(s,r,t,i),t==="mounted"&&n.match(/(FLICKR_)[0-9]{1,2}_[0-9]{1,2}_[0-9]{1,2}/g)&&(n=n.slice(0,-1)+"1"),{sku:n,orientation:r}},e.WallartHelper.prototype.getLargestSizeWallartSku=function(e,t,n,r){var i,s,o;s=this.dimensions,r||(r=[]);for(o in s[t][n]){if(e.width>=s[t][n][o][0]&&e.height>=s[t][n][o][1]){this.appContext.flipper.isFlipped("wallart-papertypes")?i=o:i?o.indexOf(i)===-1&&(i=o):i=o;if(r.indexOf(o)>-1)break;continue}i||(i=o);break}return i},e.WallartHelper.prototype.convertSkuTo=function(e,t){var n;if(t==="size")switch(e){case"FLICKR_2_1":case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":n="8x10";break;case"FLICKR_2_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":n="12x12";break;case"FLICKR_2_2":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":n="11x14";break;case"FLICKR_2_4":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":n="16x20";break;case"FLICKR_2_5":n="20x24";break;case"FLICKR_2_6":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":n="20x30"}else if(t==="size-copy")switch(e){case"FLICKR_2_1":case"FLICKR_2_9":case"FLICKR_2_9_1"
:case"FLICKR_2_9_2":case"FLICKR_2_9_3":n='8" x 10"';break;case"FLICKR_2_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":n='12" x 12"';break;case"FLICKR_2_2":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":n='11" x 14"';break;case"FLICKR_2_4":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":n='16" x 20"';break;case"FLICKR_2_5":n='20" x 24"';break;case"FLICKR_2_6":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":n='20" x 30"'}else if(t==="type")switch(e){case"FLICKR_2_1":case"FLICKR_2_3":case"FLICKR_2_2":case"FLICKR_2_4":case"FLICKR_2_5":case"FLICKR_2_6":n="canvas";break;case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_9_2":case"FLICKR_2_9_3":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_11_2":case"FLICKR_2_11_3":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_10_2":case"FLICKR_2_10_3":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_12_2":case"FLICKR_2_12_3":case"FLICKR_2_13":case"FLICKR_2_13_1":case"FLICKR_2_13_2":case"FLICKR_2_13_3":n="mounted"}else if(t==="product-description")switch(e){case"FLICKR_2_1":case"FLICKR_2_3":case"FLICKR_2_2":case"FLICKR_2_4":case"FLICKR_2_5":case"FLICKR_2_6":n={title:"Canvas Wrap",description:[this.convertSkuTo(e,"size-copy")+" gallery wrap",'1.25" stretcher bars<br>Impact resistant frame<br>Includes hardware to hang']};break;case"FLICKR_2_9":case"FLICKR_2_9_1":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display']};break;case"FLICKR_2_9_2":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display<br>Shipping within the US only']};break;case"FLICKR_2_9_3":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display<br>Shipping within the US only']};break;case"FLICKR_2_10":case"FLICKR_2_10_1":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display']};break;case"FLICKR_2_10_2":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display<br>Shipping within the US only']};break;case"FLICKR_2_10_3":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging and kickstand for table-top display<br>Shipping within the US only']};break;case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_13":case"FLICKR_2_13_1":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Premium lustre finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging']};break;case"FLICKR_2_11_2":case"FLICKR_2_12_2":case"FLICKR_2_13_2":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Glossy finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging<br>Shipping within the US only']};break;case"FLICKR_2_11_3":case"FLICKR_2_12_3":case"FLICKR_2_13_3":n={title:"Photo Mount",description:[this.convertSkuTo(e,"size-copy")+" mounted print",'Matte finish<br>1" wood-textured edge<br>Pre-drilled holes for easy hanging<br>Shipping within the US only']}}else if(t==="material")switch(e){case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_13":case"FLICKR_2_13_1":n="lustre";break;case"FLICKR_2_9_2":case"FLICKR_2_11_2":case"FLICKR_2_10_2":case"FLICKR_2_12_2":case"FLICKR_2_13_2":n="glossy";break;case"FLICKR_2_9_3":case"FLICKR_2_11_3":case"FLICKR_2_10_3":case"FLICKR_2_12_3":case"FLICKR_2_13_3":n="matte"}else if(t==="material-pretty")switch(e){case"FLICKR_2_9":case"FLICKR_2_9_1":case"FLICKR_2_11":case"FLICKR_2_11_1":case"FLICKR_2_10":case"FLICKR_2_10_1":case"FLICKR_2_12":case"FLICKR_2_12_1":case"FLICKR_2_13":case"FLICKR_2_13_1":n="Premium Lustre";break;case"FLICKR_2_9_2":case"FLICKR_2_11_2":case"FLICKR_2_10_2":case"FLICKR_2_12_2":case"FLICKR_2_13_2":n="Glossy";break;case"FLICKR_2_9_3":case"FLICKR_2_11_3":case"FLICKR_2_10_3":case"FLICKR_2_12_3":case"FLICKR_2_13_3":n="Matte"}return n},e.WallartHelper.prototype.isValidWallartType=function(e){return typeof e=="string"&&this.validWallartTypes.indexOf(e)>-1},e.WallartHelper.prototype.getCreationsThumbInfo=function(e,t){var n,r,i,s,o,u;return n=this.convertSkuTo(e,"type"),i=this.convertSkuTo(e,"size"),s=this.convertSkuTo(e,"size-copy"),r=this.convertSkuTo(e,"product-description"),i==="12x12"?o="square":o=t===0?"landscape":"portrait",r||(r={title:""}),u={type:n,size:i,sizeCopy:s,typeCopy:r.title,layout:o},u},e.WallartHelper.prototype.isPhotoWallartable=function(e,t){var n,r=[],i=[],s=[],o=[],u,a,f=[];u=this.getCorrectedLargestSize(e),t||(u.width>=u.height?t=0:t=1);for(a in this.dimensions[t].canvas){if(!(u.width>=this.dimensions[t].canvas[a][0]&&u.height>=this.dimensions[t].canvas[a][1]))break;f.indexOf(a)<0&&(r.push(a),i.push(this.convertSkuTo(a,"size")),s.push("canvas"),o.push("canvas"+this.convertSkuTo(a,"size")))}for(a in this.dimensions[t].mounted){if(!(u.width>=this.dimensions[t].mounted[a][0]&&u.height>=this.dimensions[t].mounted[a][1]))break;f.indexOf(a)<0&&(r.push(a),i.push(this.convertSkuTo(a,"size")),s.push("mounted"),o.push("mounted"+this.convertSkuTo(a,"size")))}return n={skus:r,sizes:i,types:s,typeAndSize:o},n}},"@VERSION@",{affinity:"",requires:[],optional:[]});
YUI.add("products-api-helper",function(e){function s(e,t,n,r){var i,s,o,u,a,f,l,c,h,p;if(t&&!t.isValidCoupon)throw h=new Error(t.invalidReason),h.name="CouponInvalidError",h;return i=r.couponRegistry,s=r.discountRegistry,a=[],e.id=e.couponId,f=e.discounts.discount[0],p=f.discountId,c={costDiscount:f.costDiscount,couponId:e.id,discountType:f.discountType,discountValue:f.discountValue,minPurchaseValue:f.minPurchaseValue,productEntity:f.productEntity},s.exists(p)?(s.setValues(p,c),l=s.proxy(p)):(c.id=p,l=s.add(c)),a.push(l),o={code:e.code,orderId:n,discounts:a},t&&(o.isSingleUse=t.isSingleUse,o.isUserSpecific=t.isUserSpecific,o.isValidCoupon=t.isValidCoupon),i.exists(e.id)?(i.setValues(e.id,o),u=i.proxy(e.id)):(o.id=e.id,u=i.add(o)),u}function o(e,t,n){var r,i,s;return r=n.orderItemRegistry,i=n.itemPriceRegistry,e instanceof Array&&(e=e[0]),e=e.map(function(e){var n=e.renderedProductId,o,u,a,f,l={};return l.sourceProductId=e.sourceProductId,l.productType=e.productType,l.productTitle=e.productTitle,l.quantity=e.quantity,l.cost=e.costProductUnit,l.orderId=t,e.productPrice&&(a=e.productPrice,s={priceBase:a.priceBase,countPagesBase:a.countPagesBase,countPagesExtra:a.countPagesExtra,pricePerPage:a.pricePerPage,pricePagesExtra:a.pricePagesExtra,priceTotal:a.priceTotal},a.shipping&&(f=a.shipping,f.standardShipping&&(s.standardShippingBase=f.standardShipping.priceShippingBase,s.standardShippingExtra=f.standardShipping.priceShippingExtra),f.expressShipping&&(s.expressShippingBase=f.expressShipping.priceShippingBase,s.expressShippingExtra=f.expressShipping.priceShippingExtra)),i.exists(n)?(o=i.proxy(n),o.setValues(s)):(s.id=n,o=i.add(s))),e.product&&e.product.skuId&&(l.skuId=e.product.skuId),l.price=o,r.exists(n)?(u=r.proxy(n),u.setValues(l),u):(l.id=n,r.add(l))}),e}function u(e,t){var n,r,i,s,o;o={},n=t.orderRegistry,e.orderId&&(e.id=e.orderId);if(e.couponMetadata&&!e.couponMetadata.isValidCoupon)throw s=new Error(e.couponMetadata.invalidReason),s.name="CouponInvalidError",s;return e.coupons&&(o.coupon=this.parseCoupons(e.coupons.coupon,e.couponMetadata,e.orderId,t),i=o.coupon.getValue("discounts").getList()[0],i&&i.getValue("discountType")==="percent"&&parseInt(i.getValue("discountValue"),10)===100?o.isFreeOrder=1:o.isFreeOrder=0),e.item&&(o.items=this.parseItems(e.item,e.id,t)),o.orderId=e.orderId,o.statusOrder=e.statusOrder,o.statusPrint=e.statusPrint,o.statusPayment=e.statusPayment,o.paymentMethodId=e.paymentMethodId,o.bookPreviewPdf=e.bookPreviewPdf,o.userId=e.userId,o.trackingNum=e.trackingNum,o.trackingUrl=e.trackingUrl,o.costTotal=parseFloat(e.costTotal)||0,o.costProducts=parseFloat(e.costProducts)||0,o.costShipping=e.costShipping||0,o.costDiscount=e.costDiscount||0,o.costTax=e.costTax,o.isCouponApplied=e.isCouponApplied,o.shippingType=e.shippingType||e.shipMethod||"standard_shipping",o.dateCreate=e.dateCreate,e.countryCode&&(o.countryCode=e.countryCode),n.exists(e.orderId)?(r=n.proxy(e.orderId),r.setValues(o),r):(o.id=e.orderId,n.add(o))}function a(t,n){var r=t,i=n.pageModelRegistry,s=n.bookModelRegistry,o=n.pagePhotoModelRegistry,u=n.photoModelRegistry,a=n.personRegistry,f=n.photoEngagementRegistry,l=n.photoStatsRegistry,c,h=[];if(r)return t={id:r.id,owner:r.owner,title:r.title,coverPhotoId:r.coverPageId,totalPhotos:0,price:r.price,created:r.dateCreate},r.page&&e.Array(r.page).forEach(function(n){var r=[],s;n.photo&&e.Array(n.photo).forEach(function(i){var s,h,p;e.Lang.isNumber(parseInt(i.id,10))&&(p=n.id+"_"+i.position,s={id:p,bookId:t.id,position:i.position,cropX:i.cropX/100,cropY:i.cropY/100,cropW:i.cropW/100,cropH:i.cropH/100,invalidForPrintReason:i.invalidForPrintReason,isInvalidForPrint:i.isInvalidForPrint},h=e.APIHelper.response.parsePhotos({photos:[i],personModelRegistry:a,photoModelRegistry:u,photoEngagementModelRegistry:f,photoStatsModelRegistry:l})[0],s.photo=h,c=s.id,o.exists(c)?(delete s.id,o.setValues(c,s)):o.add(s),r.push(o.proxy(c)))}),s=e.APIHelper.response.parsePage(n),s.bookId=t.id,s.pagePhotos=r,c=s.id,i.exists(c)?(delete s.id,i.setValues(c,s),n=i.proxy(c)):n=i.add(s),h.push(c),t.totalPhotos=t.totalPhotos+r.length,t.coverPage||(t.coverPage=n)}),t.pageOrder=h,s.exists(t.id)?s.setValues(t.id,{title:t.title,pageOrder:t.pageOrder,totalPhotos:t.totalPhotos,coverPage:t.coverPage}):s.add(t),t}var t,n,r,i;t={1:"Flickr Pro",2:"Flickr Pro",3:"Flickr Pro",4:"Ad Free",6:"Ad Free"},n={1:"3 months",2:"1 year",3:"2 years",4:"1 year",6:"1 month"},r={1:"Created",2:"Pending",3:"Submitted",4:"Accepted",5:"Packaged",6:"Shipped",7:"Voided",99:"Cancelled",101:"Submitted"},i={initiated:1,active:2,closed:3,canceled:4,failed:5,refunded:6,pending:7,subscription_canceled:8,subscription_charged_successfully:9,subscription_charged_unsuccessfully:10,subscription_expired:11,subscription_went_past_due:12,change_initiated:13,closed_pending:14},e.ProductsAPIHelper={parseOrder:u,parseCoupons:s,parseItems:o,parseBook:a}},"@VERSION@",{requires:[]});
YUI.add("flickr-products-books-editPage-updater",function(e){"use strict";function t(e,t){var n={};return n.page_id=e.pageId,n.book_id=e.bookId,e.templateId&&(n.template_id=e.templateId),e.backgroundColor&&(n.background_color=e.backgroundColor),t.callAPI("flickr.products.books.editPage",n).then(null,function(e){throw t[e.fatal?"error":"debug"]("[flickr-products-books-editPage-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-products-books-editPage"]={run:t}},"@VERSION@",{requires:["flickr-promise"],optional:[]});
YUI.add("flickr-products-books-getPage-fetcher",function(e){"use strict";function t(t){var n={extras:e.APIHelper.request.getRebootPhotoExtras(),book_id:t.bookId,page_id:t.id};return t.page=t.page||1,t.perPage=t.perPage||100,n}function n(e,t){var n=e[0],r=e[1],i={id:t.id,photo:[]},s=[],o=!1,u=!1;r.exists(t.id)&&(s=r.getValue(t.id,"photoList").getList(),o=s.hasMinBoundary?s.hasMinBoundary():!1,u=s.hasMaxBoundary?s.hasMaxBoundary():!1),i.pageNumber=n.pageNumber,i.template=parseInt(n.template,10),i.countPhotos=n.countPhotos,i.photo=n.photo,i.backgroundColor=n.backgroundColor,r.exists(t.id)?r.setValue(t.id,"photoList",i.photoList):r.add(i)}function r(t,n){var r=this;return e.Promise.all([n.callAPI("flickr.products.books.getPage",this._processParams(t)),n.getModelRegistry("page-models")]).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-products-books-getPage-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-products-books-getPage"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models"]});
YUI.add("flickr-products-books-setPagePhoto-updater",function(e){"use strict";function t(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f=r.page,l=[],c,h;f&&(f.photo&&e.Array(f.photo).forEach(function(t){var r,i,c,p,d;d=f.id+"_"+t.position,r={id:d,bookId:n.bookId,position:t.position,cropX:t.cropX/100,cropY:t.cropY/100,cropW:t.cropW/100,cropH:t.cropH/100,invalidForPrintReason:t.invalidForPrintReason,isInvalidForPrint:t.isInvalidForPrint},i=e.APIHelper.response.parsePhoto(t),c=i.owner,p=i.engagement,h=c.id,u.exists(h)?(delete c.id,u.setValues(h,c)):u.add(c),i.owner=u.proxy(h),h=p.id,a.exists(h)?(delete p.id,a.setValues(h,p)):a.add(p),i.engagement=a.proxy(h),h=i.id,o.exists(h)?(delete i.id,o.setValues(h,i)):o.add(i),r.photo=o.proxy(h),h=r.id,s.exists(h)?(delete r.id,s.setValues(h,r)):s.add(r),l.push(s.proxy(h))}),c=e.APIHelper.response.parsePage(f),c.pagePhotos=l,h=c.id,i.exists(h)?(delete c.id,i.setValues(h,c)):i.add(c))}function n(n,r){var i={};return i.page_id=n.pageId,i.book_id=n.bookId,i.position=n.position,i.photo_id=n.photoId,i.crop_x=Math.round(Math.abs(n.cropX*100)),i.crop_y=Math.round(Math.abs(n.cropY*100)),i.crop_w=Math.round(Math.abs(n.cropW*100)),i.crop_h=Math.round(Math.abs(n.cropH*100)),i.extras=e.APIHelper.request.getRebootPhotoExtras(),e.Promise.all([r.callAPI("flickr.products.books.setPagePhoto",i),r.getModelRegistry("page-models"),r.getModelRegistry("book-page-photo-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photo-engagement-models")]).then(function(e){return t(e,n)},function(e){throw r[e.fatal?"error":"debug"]("[flickr-products-books-setPagePhoto-updater] failed getting or processing API response:",e),e})}e.namespace("ModelUpdaters")["flickr-products-books-setPagePhoto"]={run:n}},"@VERSION@",{requires:["flickr-promise"],optional:["page-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("book-page-photo-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(e){},create:function(t){return e.ModelUpdaters["flickr-products-books-setPagePhoto"].run({create:!0,pageId:t.pageId,bookId:t.bookId,position:1,photoId:t.photoId,template:2,cropX:0,cropY:0,cropW:0,cropH:0},this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)}},attributes:{bookId:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},photo:{isModel:!0},cropW:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropH:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropX:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropY:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},position:{defaultFn:function(){return 1},getter:function(e){return parseInt(e,10)||1},defaultValue:1},isLowQuality:{defaultFn:function(){return 0}},invalidForPrintReason:{},isInvalidForPrint:{defaultFn:function(){return 0}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-setPagePhoto-updater"]});
YUI.add("flickr-products-books-updateBook-updater",function(e){"use strict";function t(t,n){return e.batch(n.getModel("book-models",t),n.getModelRegistry("page-models")).then(function(e){var t,r={},i,s=e[0],o=e[1];return t={id:""+s.id,owner:n.getViewer().nsid,title:s.getValue("title")},i=s.getValue("pageOrder"),t.count_pages=i.length-1,i.forEach(function(e,t){var n,i={},s,u;s=o.proxy(e),n={id:s.id,page_number:s.getValue("pageNumber")+"",count_photos:s.getValue("countPhotos")+"",template:s.getValue("template")+"",background_color:s.getValue("backgroundColor")},u=s.getValue("pagePhotos").getList(),u=u.forEach(function(e,t){var n;e.getValue("photo")&&(n={id:e.getValue("photo").id,position:t+1+"",crop_x:e.getValue("cropX")*100+"",crop_y:e.getValue("cropY")*100+"",crop_w:e.getValue("cropW")*100+"",crop_h:e.getValue("cropH")*100+"",low_quality:e.getValue("isLowQuality"),is_invalid_for_print:e.getValue("isInvalidForPrint")},i[t+1]=n)}),n.photos=i,r[t]=n}),t.pages=r,t})}function n(t,n,r){var i=this;return this.serialize(t,n).then(function(r){return n.callAPI("flickr.products.books.updateBook",{book:JSON.stringify(r)}).then(function(r){if(r[0]&&r[0].badPhotos)e.fire("bookUpdater:failure",{badPhotos:r[0].badPhotos});else if(i.pendingUpdate)return i.pendingUpdate=!1,i.startNextUpdate(t,n)},function(e){throw i.pendingUpdate&&(i.pendingUpdate=!1),n[e.fatal?"error":"debug"]("[flickr-products-books-updateBook-updater] failed getting or processing API response: ",e),e})})}function r(){return this.updateInFlight=null,!0}function i(e,t){return this.updateInFlight=this.callAPI(e,t).then(this.clearUpdateInFlight.bind(this),this.clearUpdateInFlight.bind(this)),this.updateInFlight}function s(e,t){return this.pendingUpdate=null,this.startUpdate(e,t)}function o(e,t){var n=e.bookId;return this.pendingUpdate?this.updateInFlight:this.updateInFlight?(this.pendingUpdate=!0,this.updateInFlight):this.startUpdate(n,t)}e.namespace("ModelUpdaters")["flickr-products-books-updateBook"]={run:o,serialize:t,callAPI:n,clearUpdateInFlight:r,startUpdate:i,startNextUpdate:s}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models"]});
YUI.add("api-products-books-helper",function(e){function t(t,n,r,i){var s=t.book,o,u,a=[];s&&(u={id:s.id,owner:s.owner,title:s.title,coverPhotoId:s.coverPhotoId},s.page&&e.Array(s.page).forEach(function(t){n.exists(t.id)?o=e.APIHelper.response.parsePage(t):n.add(e.APIHelper.response.parsePage(t)),a.push(n.proxy(t.id))}),u.pages=a,r.exists(u.id)?r.setValues(u.id,{title:u.title,pages:u.pages,coverPhotoId:u.coverPhotoId}):r.add(u))}e.APIProductsBooksHelper={processDefaultResponse:t}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});
YUI.add("flickr-products-books-editBook-updater",function(e){"use strict";function t(t,n){var r={};return r.book_id=t.bookId,r.title=t.title,e.Promise.all([n.callAPI("flickr.products.books.editBook",r),n.getModelRegistry("book-models")]).then(function(e){return self._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-products-books-editBook-updater] failed getting or processing API response: ",e),e})}e.namespace("ModelUpdaters")["flickr-products-books-editBook"]={run:t}},"@VERSION@",{requires:["flickr-promise","api-helper","api-products-books-helper"],optional:["page-models","book-models"]});
YUI.add("flickr-products-books-creator",function(e){"use strict";function t(t){var n={};return t=t||{},n=t,n.cacheBust=Date.now(),n.extras=e.APIHelper.request.getRebootPhotoExtras(),n}function n(t,n){var r,i;return r={pageModelRegistry:t.pageModelRegistry,bookModelRegistry:t.bookModelRegistry,pagePhotoModelRegistry:t.pagePhotoModelRegistry,photoModelRegistry:t.photoModelRegistry,personRegistry:t.personRegistry,photoEngagementRegistry:t.photoEngagementRegistry,photoStatsRegistry:t.photoStatsRegistry},i=e.ProductsAPIHelper.parseBook(t.response.book,r),i}function r(t,n){var r=this;return(new e.FlickrPromise({response:n.callAPI("flickr.products.books.create",this._processParams(t)),pageModelRegistry:n.getModelRegistry("page-models"),bookModelRegistry:n.getModelRegistry("book-models"),pagePhotoModelRegistry:n.getModelRegistry("book-page-photo-models"),photoModelRegistry:n.getModelRegistry("photo-models"),personRegistry:n.getModelRegistry("person-models"),photoEngagementRegistry:n.getModelRegistry("photo-engagement-models"),photoStatsRegistry:n.getModelRegistry("photo-stats-models")})).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-products-books-creator] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-products-books-creator"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books"].run(t,this.appContext)},update:function(t,n){return"title"in n?e.ModelUpdaters["flickr-products-books-editBook"].run({bookId:t,title:n.title.newVal},this.appContext):e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:t},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-creator"].run(t,this.appContext)}},movePage:function(e,t,n,r){var i,s,o,u;return i=this.getValue(e,"pageOrder"),s=i.length,t<s&&n<s&&(r?u=i.splice(t,2):u=i.splice(t,1)[0],o=[n,0].concat(u),Array.prototype.splice.apply(i,o)),this.setValue(e,"pageOrder",i),i},addPage:function(e,t,n){var r,i;return r=this.getValue(e,"pageOrder"),i=r.length,n<=i&&r.splice(n+1,0,t),this.setValue(e,"pageOrder",r),r},removePage:function(e,t){var n,r,i,s;return n=this.getValue(e,"pageOrder"),s=n.length,r=n.indexOf(t),r<s&&(i=n.splice(r,1),this.setValue(e,"pageOrder",n)),n},attributes:{title:{},owner:{},pageOrder:{},coverPage:{isModel:!0},totalPhotos:{},price:{},lastPageViewed:{},created:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater","flickr-products-books-creator"]});
YUI.add("flickr-products-books-addPage-creator",function(e){"use strict";function t(t){var n={book_id:t.bookId};return t.photoIds&&(n.photo_ids=t.photoIds.join(","),n.extras=e.APIHelper.request.getRebootPhotoExtras()),e.Lang.isNumber(t.templateId)&&(n.template_id=t.templateId),t.backgroundColor&&(n.background_color=t.backgroundColor),n}function n(t,n,r){var i=t[0],s=t[1],o=t[2],u=t[3],a=t[4],f=t[5],l=t[6],c=[],h,p=i.page,d,v;return p.photo&&e.Array(p.photo).forEach(function(t){var r,i,s,f,h;h=p.id+"_"+t.position,r={id:h,bookId:n.bookId,position:t.position,cropX:t.cropX/100,cropY:t.cropY/100,cropW:t.cropW/100,cropH:t.cropH/100,invalidForPrintReason:t.invalidForPrintReason,isInvalidForPrint:t.isInvalidForPrint},i=e.APIHelper.response.parsePhoto(t),s=i.owner,f=i.engagement,d=s.id,a.exists(d)?(delete s.id,a.setValues(d,s)):a.add(s),i.owner=a.proxy(d),d=f.id,l.exists(d)?(delete f.id,l.setValues(d,f)):l.add(f),i.engagement=l.proxy(d),d=i.id,u.exists(d)?(delete i.id,u.setValues(d,i)):u.add(i),r.photo=u.proxy(d),d=r.id,o.exists(d)?(delete r.id,o.setValues(d,r)):o.add(r),c.push(o.proxy(d))}),v=e.APIHelper.response.parsePage(p),v.pagePhotos=c,v.bookId=n.bookId,d=v.id,s.exists(d)?(delete v.id,s.setValues(d,v),h=s.proxy(d)):h=s.add(v),f.proxy(n.bookId).getValue("pages").appendToList(h),h}function r(t,n){var r=this;return e.Promise.all([n.callAPI("flickr.products.books.addPage",this._processParams(t)),n.getModelRegistry("page-models"),n.getModelRegistry("book-page-photo-models"),n.getModelRegistry("photo-models"),n.getModelRegistry("person-models"),n.getModelRegistry("book-models"),n.getModelRegistry("photo-engagement-models")]).then(function(e){return r._processResponse(e,t,n)},function(e){throw n.error("[flickr-products-books-addPage-creator] failed getting or processing API response:",e),e})}e.namespace("ModelCreators")["flickr-products-books-addPage"]={run:r,_processParams:t,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("flickr-products-books-removePage-deletor",function(e){"use strict";function t(e,t){var n=e[1],r=e[0],i=n.book,s;i&&(s={id:i.id,price:i.price},r.exists(s.id)&&r.setValues(s.id,{price:s.price}))}function n(t,n,r){var i={},s=this;return i.page_id=t,i.book_id=n,e.Promise.all([r.getModelRegistry("book-models"),r.callAPI("flickr.products.books.removePage",i)]).then(function(e){return s._processResponse(e)},function(e){throw r[e.fatal?"error":"debug"]("[flickr-products-books-removePage-deletor] failed getting or processing API response: ",e),e})}e.namespace("ModelDeletors")["flickr-products-books-removePage"]={run:n,_processResponse:t}},"@VERSION@",{requires:[],optional:[]});
YUI.add("page-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-products-books-getPage"].run(t,this.appContext)},update:function(t,n){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},create:function(t){return e.ModelCreators["flickr-products-books-addPage"].run(t,this.appContext)},"delete":function(t){return e.ModelDeletors["flickr-products-books-removePage"].run(t,this.getValue(t,"bookId"),this.appContext)}},forceUpdate:function(t){return e.ModelUpdaters["flickr-products-books-updateBook"].run({bookId:this.getValue(t,"bookId")},this.appContext)},attributes:{bookId:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},backgroundColor:{defaultValue:"255,255,255"},pageNumber:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},template:{getter:function(e){return parseInt(e,10)},validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},countPhotos:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)},defaultValue:0},pagePhotos:{isListProxy:!0}}})},"@VERSION@",{requires:["flickr-products-books-editPage-updater","flickr-products-books-getPage-fetcher","flickr-products-books-addPage-creator","flickr-products-books-removePage-deletor","flickr-model-registry","flickr-promise"]});
YUI.add("flickr-products-books-fetcher",function(e){"use strict";function t(t){t.page=t.page||1,t.perPage=t.perPage||100;var n={book_id:t.id,extras:e.APIHelper.request.getRebootPhotoExtras()};return n}function n(t,n){var r,i;return r={pageModelRegistry:t.pageModelRegistry,bookModelRegistry:t.bookModelRegistry,pagePhotoModelRegistry:t.pagePhotoModelRegistry,photoModelRegistry:t.photoModelRegistry,personRegistry:t.personRegistry,photoEngagementRegistry:t.photoEngagementRegistry,photoStatsRegistry:t.photoStatsRegistry},i=e.ProductsAPIHelper.parseBook(t.response.book,r),i}function r(t,n){var r=this;return(new e.FlickrPromise({response:n.callAPI("flickr.products.books.getBook",this._processParams(t)),pageModelRegistry:n.getModelRegistry("page-models"),bookModelRegistry:n.getModelRegistry("book-models"),pagePhotoModelRegistry:n.getModelRegistry("book-page-photo-models"),photoModelRegistry:n.getModelRegistry("photo-models"),personRegistry:n.getModelRegistry("person-models"),photoEngagementRegistry:n.getModelRegistry("photo-engagement-models"),photoStatsRegistry:n.getModelRegistry("photo-stats-models")})).then(function(e){return r._processResponse(e,t)},function(e){throw n[e.fatal?"error":"debug"]("[flickr-products-books-fetcher] failed getting or processing API response:",e),e})}e.namespace("ModelFetchers")["flickr-products-books"]={run:r,_processResponse:n,_processParams:t}},"@VERSION@",{requires:["flickr-promise","api-helper","products-api-helper"],optional:["page-models","book-models","book-page-photo-models","photo-models","person-models","photo-engagement-models"]});
YUI.add("basic-book-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,attributes:{title:{},owner:{},coverPhoto:{isModel:!0},coverPhotoDeleted:{defaultFn:function(){return!1}},cropW:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropH:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropX:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},cropY:{setter:function(e){return Math.abs(e)||0},getter:function(e){return parseFloat(e,10)||0},defaultFn:function(){return 0},defaultValue:0},totalPages:{},created:{getter:function(e){return parseInt(e,10)}},updated:{getter:function(e){return parseInt(e,10)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-products-books-fetcher","flickr-products-books-updateBook-updater","flickr-products-books-editBook-updater"]});
